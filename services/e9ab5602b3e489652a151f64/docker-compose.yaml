services:
  rias-gremory:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: rias-gremory-bot
    ports:
      - "41220:3000"
    environment:
      - NODE_ENV=production
      - PORT=3000
      # Required environment variables
      - SESSION_ID=${SESSION_ID:-}
      - OWNER_NUMBER=${OWNER_NUMBER:-2348086541281}
      - OWNER_NAME=${OWNER_NAME:-toxxic}
      # Database connections (external services)
      - MONGODB_URI=${MONGODB_URI:-mongodb+srv://astrofx0011:astro@cluster0.lmwnxdt.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0}
      - DATABASE_URL=${DATABASE_URL:-postgresql://tkm:Aqi6tqwyv5IwDHncTtVi5XtMGZvfndDJ@dpg-cqahogtds78s739sl81g-a.oregon-postgres.render.com/takudzwa}
      # Bot configuration
      - PREFIX=${PREFIX:-.}
      - MODE=${MODE:-private}
      - WORKTYPE=${WORKTYPE:-private}
      - SUDO=${SUDO:-2348086541281}
      - TZ=${TZ:-Africa/Lagos}
      - TIME_ZONE=${TIME_ZONE:-Africa/Lagos}
      - BOT_NAME=${BOT_NAME:-RIAS GREMORY}
      # Feature toggles
      - WELCOME=${WELCOME:-false}
      - GOODBYE=${GOODBYE:-false}
      - WARN_COUNT=${WARN_COUNT:-3}
      - AUTO_READ_STATUS=${AUTO_READ_STATUS:-true}
      - AUTO_SAVE_STATUS=${AUTO_SAVE_STATUS:-false}
      - DISABLE_PM=${DISABLE_PM:-false}
      - DISABLE_GROUPS=${DISABLE_GROUPS:-false}
      - MSGS_IN_LOG=${MSGS_IN_LOG:-false}
      - READ_MESSAGE=${READ_MESSAGE:-false}
      - READ_COMMAND=${READ_COMMAND:-false}
      - WAPRESENCE=${WAPRESENCE:-recording}
      # Appearance
      - MENU=${MENU:-1}
      - STYLE=${STYLE:-1}
      - THUMB_IMAGE=${THUMB_IMAGE:-https://telegra.ph/file/c21ae479aab857b4f8006.jpg}
      - IMAGE=${IMAGE:-https://telegra.ph/file/c21ae479aab857b4f8006.jpg}
      - USER_IMAGES=${USER_IMAGES:-https://telegra.ph/file/84a935261759d92084744.mp4}
      - PACK_NAME=${PACK_NAME:-RIAS MD}
      - PACK_AUTHER=${PACK_AUTHER:-toxxic md}
      - THEME=${THEME:-RIAS}
      - VERSION=${VERSION:-1.3.1}
      - BRANCH=${BRANCH:-main}
      - CAPTION=${CAPTION:-POWERED BY TOXXIC BOY}
      # Security
      - ERROR_CHAT=${ERROR_CHAT:-}
      - ALLOW_JID=${ALLOW_JID:-null}
      - BLOCK_JID=${BLOCK_JID:-null}
      # API Keys (optional)
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - ELEVENLAB_API_KEY=${ELEVENLAB_API_KEY:-}
      - REMOVE_BG_KEY=${REMOVE_BG_KEY:-neLbXXrp8bSDcohnp1CW5UEa}
      # Group settings
      - ANTILINK_VALUES=${ANTILINK_VALUES:-all}
      # Deployment
      - APP_URL=${APP_URL:-}
      - KOYEB_API=${KOYEB_API:-false}
      - AITTS_ID=${AITTS_ID:-37}
    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 4G
        reservations:
          cpus: '1.0'
          memory: 1G
    restart: unless-stopped
    working_dir: /app
    volumes:
      - ./session_data:/app/session_data
    healthcheck:
      test: ["CMD", "wget", "--spider", "-q", "http://localhost:3000"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s