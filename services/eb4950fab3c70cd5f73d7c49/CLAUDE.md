# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is the **Arco Design Vue 2.0** component library monorepo - a comprehensive Vue 3 UI component library based on the Arco Design system. It contains 60+ crafted components.

## Monorepo Structure

```
packages/
├── web-vue/           # Main UI component library (@arco-design/web-vue)
├── arco-vue-docs/     # Documentation website
├── arco-vue-scripts/  # Build scripts and CLI tools
├── arco-changelog/    # Changelog generator
└── web-vue-storybook/ # Storybook for component development
```

## Common Commands

```bash
# Install dependencies
pnpm install

# Initialize project (run after fresh install)
pnpm run init

# Start documentation site for development
pnpm run start

# Run tests (in web-vue package)
pnpm run test

# Update snapshots after DOM changes
pnpm run test:update

# Run screenshot tests
pnpm run test:screenshot

# Build component library
pnpm run build:component

# Build documentation site
pnpm run build:site

# Regenerate component documentation (after API changes)
pnpm run docgen

# Run Storybook
pnpm run storybook
```

## Component Architecture

Each component follows a consistent directory structure in `packages/web-vue/components/<component-name>`:

```
├── index.ts            # Component export with install method
├── <component>.vue     # Main component file
├── <component>-group.vue  # Sub-component (if applicable)
├── interface.ts        # TypeScript props interface
├── constants.ts        # Component-specific constants
├── context.ts          # Provide/inject context for sub-components
├── style/
│   ├── index.less      # Component styles
│   └── index.ts        # Style entry point
├── __test__/
│   ├── index.test.ts   # Unit tests
│   ├── demo.test.ts    # Snapshot tests for demos
│   └── __snapshots__/  # Auto-generated snapshots
└── __demo__/
    ├── basic.md        # Basic usage demo
    └── advanced.md     # Advanced usage demo
```

### Component File Patterns

- **Props interface**: Define with JSDoc annotations in Chinese (`@zh`) and English (`@en`) for auto-generated docs
- **Emits**: Document in the `emits` section with event payload types
- **Slots**: Document with `@slot` annotations
- **Sub-components**: Use `provide/inject` with `InjectionKey` (e.g., `buttonGroupInjectionKey`)
- **Shared hooks**: Use hooks from `_hooks/` (e.g., `useFormItem`, `useSize`, `useTrigger`)
- **Shared utilities**: Use utilities from `_utils/` (e.g., `getPrefixCls`, `global-config`)

### Demo Files

Demo files are markdown with embedded Vue templates using frontmatter for titles:

```markdown
```yaml
title:
  zh-CN: 基本用法
  en-US: Basic Usage
```

## zh-CN
Description in Chinese...

## en-US
Description in English...

```vue
<template>
  <a-button type="primary">Primary</a-button>
</template>
```
```

## Styling

- Components use **Less** for styling with CSS variable-based theming
- Style files follow BEM-like naming with prefix (`arco-btn-primary`, etc.)
- Use `getPrefixCls('btn')` to generate class names consistently

## Build System

The `arco-vue-scripts` package provides CLI commands:

- `arco-vue-scripts dev:component` - Watch mode for component development
- `arco-vue-scripts docgen` - Generate README docs from TypeScript comments
- `arco-vue-scripts icongen` - Generate icon components from SVG files
- `arco-vue-scripts dtsgen` - Emit TypeScript declaration files
- `arco-vue-scripts build:style` - Build compiled CSS

## Linting & Formatting

- **ESLint**: Airbnb base + TypeScript + Vue rules
- **Prettier**: Code formatting
- **Stylelint**: CSS/Less ordering (rational-order)
- **Husky + lint-staged**: Pre-commit hooks

## Testing

- **Jest** with `vue-jest` for Vue components and `babel-jest` for TypeScript
- Unit tests use `@vue/test-utils` `mount()` for component testing
- Demo snapshots capture rendered demo output
- Run specific component tests: `pnpm --filter @arco-design/web-vue run test -- --testPathPattern=button`

## Key Conventions

- Commit messages follow [Conventional Commits](https://www.conventionalcommits.org/): `feat(button): add new prop`, `fix(input): fix validation bug`
- New features → `feature` branch; other changes → `main` branch
- Component APIs documented in JSDoc are auto-generated into README files
- Don't edit `README.zh-CN.md` or `README.en-US.md` directly—they're generated by `docgen`